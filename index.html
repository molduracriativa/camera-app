<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
<title>Camera com Moldura ‚Äî 9:16 Foto & V√≠deo MP4</title>

<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{
    width:100%;height:100%;
    background:#000;color:#fff;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
    -webkit-user-select:none; user-select:none;
    -webkit-touch-callout:none; touch-action:manipulation;
    overflow:hidden;
  }

  /* ------------------ layout ------------------ */
  #enable-btn{
    position:fixed; left:50%; top:50%;
    transform:translate(-50%,-50%);
    background:#fff; color:#000;
    border:none; padding:16px 26px;
    border-radius:12px; font-size:18px;
    z-index:100000;
    touch-action:manipulation;
  }

  /* video (hidden until start) - behind canvas */
  #video {
    display:none;
    position:fixed; inset:0;
    width:100vw; height:100vh;
    object-fit:cover;
    z-index:1;
    pointer-events:none;
  }

  /* canvas is the main rendered output; will be 1080x1920 and scaled to fit screen */
  #render-canvas {
    display:none;
    position:fixed; left:50%; top:50%;
    transform:translate(-50%,-50%);
    width:100vw; height:100vh;
    max-width:100vh; /* keep responsive */
    z-index:2;
    background:#000;
    touch-action:none;
    pointer-events:none; /* ensure buttons above receive touches */
  }

  /* overlay image kept for loading; hidden but pointer-events none */
  #overlay {
    display:none;
    pointer-events:none;
  }

  /* controls on top */
  #controls {
    display:none;
    position:fixed;
    bottom:26px; left:0; right:0;
    width:100%;
    justify-content:center;
    gap:18px;
    z-index:100001;
    pointer-events:auto;
  }
  .btn {
    width:68px; height:68px; border-radius:50%;
    border:none; background:#fff; color:#000;
    box-shadow:0 8px 20px rgba(0,0,0,0.4);
    font-size:26px; display:flex; align-items:center; justify-content:center;
    cursor:pointer; pointer-events:auto;
  }
  .btn.red{ background:#e53935; color:#fff; }

  /* preview area */
  #preview {
    display:none;
    position:fixed;
    left:50%; bottom:120px;
    transform:translateX(-50%);
    z-index:100002;
    align-items:center; gap:10px; flex-direction:column;
    pointer-events:auto;
  }
  #preview video, #preview img {
    width:86vw; max-width:360px; border-radius:10px;
    border:3px solid #fff; background:#000;
    display:block;
  }
  .action-save { background:#4CAF50; color:#fff; padding:10px 18px; border-radius:8px; border:none; font-size:16px; cursor:pointer; width:180px; }

  /* status text */
  #status { position:fixed; top:12px; left:12px; background:rgba(0,0,0,0.5); padding:8px 10px; border-radius:10px; z-index:100010; font-size:13px; display:none; pointer-events:none; color:#fff; }

  /* ensure interactive elements receive pointer */
  #controls, #controls * { pointer-events:auto !important; }
  #preview, #preview * { pointer-events:auto !important; }

  /* responsive hint: maintain aspect ratio style */
  @media (orientation:landscape){
    /* on landscape we still scale canvas to height */
  }
</style>
</head>
<body>

<!-- Initial interaction required on mobile -->
<button id="enable-btn">Ativar C√¢mera</button>

<!-- raw video (hidden) -->
<video id="video" autoplay playsinline muted></video>

<!-- overlay image (transparent PNG) - keep in same folder -->
<img id="overlay" src="moldura.png" alt="moldura" />

<!-- canvas ‚Äî will be set to 1080 x 1920 logical pixels and scaled to screen -->
<canvas id="render-canvas" width="1080" height="1920"></canvas>

<!-- controls -->
<div id="controls">
  <button id="switch-btn" class="btn" title="Trocar c√¢mera">üîÑ</button>
  <button id="photo-btn" class="btn" title="Tirar foto">üì∏</button>
  <button id="record-btn" class="btn" title="Gravar">üé•</button>
  <button id="stop-btn" class="btn red" title="Parar" style="display:none">‚èπÔ∏è</button>
</div>

<!-- preview area -->
<div id="preview">
  <video id="preview-video" controls playsinline style="display:none"></video>
  <img id="preview-photo" style="display:none"/>
  <button id="save-btn" class="action-save">Salvar</button>
  <button id="retry-btn" class="action-save" style="background:#777;margin-top:6px">Tentar novamente</button>
</div>

<div id="status"></div>

<!-- FFmpeg WASM -->
<script src="https:/
